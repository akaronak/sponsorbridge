# ═══════════════════════════════════════════════════════
# Eventra Platform — Common Configuration
# Active profile set via SPRING_PROFILES_ACTIVE env var
# ═══════════════════════════════════════════════════════

server.port=${SERVER_PORT:8080}
server.servlet.context-path=/
spring.application.name=eventra

# ─── MongoDB Atlas ────────────────────────────────────
# Local dev default; overridden by prod profile / env var
spring.data.mongodb.uri=${MONGODB_URI:mongodb://localhost:27017/eventra}
spring.data.mongodb.auto-index-creation=true
spring.data.mongodb.uuid-representation=standard

# ─── Redis ────────────────────────────────────────────
spring.data.redis.host=${REDIS_HOST:localhost}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD:}
spring.data.redis.timeout=2000ms
spring.data.redis.lettuce.pool.max-active=16
spring.data.redis.lettuce.pool.max-idle=8
spring.data.redis.lettuce.pool.min-idle=2
spring.data.redis.lettuce.pool.max-wait=500ms
spring.data.redis.lettuce.shutdown-timeout=200ms

# ─── Caching ─────────────────────────────────────────
spring.cache.type=redis
spring.cache.redis.time-to-live=600000
spring.cache.redis.cache-null-values=false
spring.cache.redis.key-prefix=eventra:cache:

# ─── Rate Limiting ───────────────────────────────────
rate-limit.default.capacity=100
rate-limit.default.refill-tokens=100
rate-limit.default.refill-duration=60
rate-limit.admin.capacity=500
rate-limit.admin.refill-tokens=500
rate-limit.admin.refill-duration=60
rate-limit.anonymous.capacity=30
rate-limit.anonymous.refill-tokens=30
rate-limit.anonymous.refill-duration=60

# ─── JWT ──────────────────────────────────────────────
jwt.secret=${JWT_SECRET:your-secret-key-change-this-in-production-with-a-strong-key-at-least-256-bits}
jwt.expiration=${JWT_EXPIRATION:86400000}

# ─── Cloudinary ──────────────────────────────────────
cloudinary.cloud-name=${CLOUDINARY_CLOUD_NAME:}
cloudinary.api-key=${CLOUDINARY_API_KEY:}
cloudinary.api-secret=${CLOUDINARY_API_SECRET:}

# ─── Gemini AI ───────────────────────────────────────
gemini.api.key=${GEMINI_API_KEY:}
gemini.api.timeout=30

# ─── Razorpay Payment Gateway ───────────────────────
payment.razorpay-key-id=${RAZORPAY_KEY_ID:}
payment.razorpay-key-secret=${RAZORPAY_KEY_SECRET:}
payment.razorpay-webhook-secret=${RAZORPAY_WEBHOOK_SECRET:}

# ─── Escrow & Commission ────────────────────────────
payment.escrow-hold-days=${ESCROW_HOLD_DAYS:7}
payment.dispute-auto-resolve-days=${DISPUTE_AUTO_RESOLVE_DAYS:14}
payment.commission-percent=${COMMISSION_PERCENT:10.0}
payment.min-commission=${MIN_COMMISSION:1.00}
payment.max-payment-amount=${MAX_PAYMENT_AMOUNT:10000000.00}
payment.idempotency-key-ttl-hours=48
payment.webhook-replay-window-seconds=300

# ─── Scheduling ─────────────────────────────────────
spring.task.scheduling.pool.size=2
payment.escrow-release-cron=0 0 * * * *
payment.dispute-resolve-cron=0 0 */4 * * *

# ─── Actuator / Observability ────────────────────────
management.endpoints.web.exposure.include=health,info,metrics,prometheus,caches
management.endpoint.health.show-details=when-authorized
management.endpoint.health.probes.enabled=true
management.metrics.tags.application=eventra
management.prometheus.metrics.export.enabled=true

# ─── Logging ─────────────────────────────────────────
logging.level.root=INFO
logging.level.com.eventra=DEBUG
logging.level.org.springframework.data.mongodb=INFO
logging.level.org.springframework.cache=DEBUG
logging.level.io.lettuce.core=INFO
