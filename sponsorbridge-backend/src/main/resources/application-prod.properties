# ═══════════════════════════════════════════════════════
# Eventra Platform — PRODUCTION Profile
# Activated via: SPRING_PROFILES_ACTIVE=prod
# ═══════════════════════════════════════════════════════

# ─── MongoDB Atlas (TLS/SRV) ─────────────────────────
# Connection string from Atlas dashboard:
#   mongodb+srv://<user>:<pass>@<cluster>.mongodb.net/<db>?retryWrites=true&w=majority
spring.data.mongodb.uri=${MONGODB_URI}
spring.data.mongodb.auto-index-creation=false

# ─── Redis (AWS ElastiCache / Azure Cache) ───────────
spring.data.redis.host=${REDIS_HOST}
spring.data.redis.port=${REDIS_PORT:6379}
spring.data.redis.password=${REDIS_PASSWORD}
spring.data.redis.ssl.enabled=${REDIS_SSL:true}
spring.data.redis.lettuce.pool.max-active=32
spring.data.redis.lettuce.pool.max-idle=16
spring.data.redis.lettuce.pool.min-idle=4
spring.data.redis.lettuce.pool.max-wait=1000ms
spring.data.redis.timeout=3000ms

# ─── Security ────────────────────────────────────────
jwt.secret=${JWT_SECRET}
jwt.expiration=${JWT_EXPIRATION:43200000}

# ─── Rate Limiting (tighter for production) ──────────
rate-limit.default.capacity=100
rate-limit.default.refill-tokens=100
rate-limit.default.refill-duration=60
rate-limit.admin.capacity=500
rate-limit.admin.refill-tokens=500
rate-limit.admin.refill-duration=60
rate-limit.anonymous.capacity=20
rate-limit.anonymous.refill-tokens=20
rate-limit.anonymous.refill-duration=60

# ─── Actuator (lock down in prod) ────────────────────
management.endpoints.web.exposure.include=health,info,prometheus
management.endpoint.health.show-details=never

# ─── Logging ─────────────────────────────────────────
logging.level.root=WARN
logging.level.com.eventra=INFO
logging.level.org.springframework.data.mongodb=WARN
logging.level.org.springframework.cache=WARN
logging.level.io.lettuce.core=WARN

# ─── Server tuning ──────────────────────────────────
server.tomcat.threads.max=200
server.tomcat.threads.min-spare=20
server.tomcat.accept-count=100
server.tomcat.max-connections=10000
server.compression.enabled=true
server.compression.min-response-size=1024
